<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>完成注册</title>
<#include "/_inc/head.html">
<script type="text/javascript">
<!--
$(function() {
	var areas = ${areaJson};
	$("#province").change(function() {
		var value = this.options[this.selectedIndex].value;
		var city = $("#city option:selected").val() || "${(params.area[1])!}";
		var cities = areas[value];
		$("#city").empty();
		if (cities) {
			for (var key in cities) {
				var opt = document.createElement("option");
				opt.value = key;
				opt.text = key;
				opt.selected = key == city;
				$("#city").append(opt);
			}
			$("#city").change();
		}
	});
	$("#city").change(function() {
		var value = this.options[this.selectedIndex].value;
		var prov = $("#province option:selected").val();
		var dist = $("#district option:selected").val() || "${(params.area[2])!}";
		var dists = areas[prov][value];
		$("#district").empty();
		if (dists) {
			for (var i = 0; i < dists.length; i++) {
				var opt = document.createElement("option");
				opt.value = dists[i];
				opt.text = dists[i];
				opt.selected = dists[i] == dist;
				$("#district").append(opt);
			}
		}
	});
	
	$("#birthYear,#birthMonth").change(function() {
		var year = parseInt($("#birthYear option:selected").val()),
			month = parseInt($("#birthMonth option:selected").val()),
			date = parseInt($("#birthDate option:selected").val() || "${(params.birthday[2])!}");
		$("#birthDate").html("<option />");
		if (year && month) {
			var dates;
			switch (month) {
			case 4: case 6: case 9: case 11:
				dates = 30;
				break;
			case 2:
				dates = (year % 4 == 0 && year % 100 != 0) || year % 400 == 0 ? 29 : 28;
				break;
			default:
				dates = 31;
				break;
			}
			for (var i = 1; i <= dates; i++) {
				var opt = document.createElement("option");
				opt.value = i < 10 ? "0" + i : i;
				opt.text = i;
				opt.selected = i == date;
				$("#birthDate").append(opt);
			}
		}
	});
	
	var gradeLevels = ${gradeLevelJson};
	$("#grades input:radio").change(function() {
		if (!this.checked) return;
		var value = this.value;
		var level = parseInt($("#grades select option:selected").val() || "${params.gradeLevel!}");
		var levels = gradeLevels[value];
		$("#grades select").empty();
		if (levels) {
			for (var i = 0; i < levels.length; i++) {
				var opt = document.createElement("option");
				opt.value = i + 1;
				opt.text = levels[i];
				opt.selected = i + 1 == level;
				$("#grades select").append(opt);
			}
		}
	});
	
	$("#answerAll").change(function() {
		var checked = this.checked, val;
		$("#answers input:text").each(function(i) {
			if (i == 0)
				val = this.value;
			else if (checked)
				this.value = val;
		});
	});
	$("#answers input:text").change(function() {
		if ($("#answerAll")[0].checked)
			$("#answers input:text").val(this.value);
	});
	
	$("#province,#birthYear,#grades input:radio,#answerAll").change();
});
//-->
</script>
</head>
<body>
<table id="box" border="0" cellspacing="5" cellpadding="0" class="ui-widget-content">
<#include "/_inc/bar.html">
<tbody>
	<tr>
		<td height="99%" align="left" valign="top">
			<!-- REPLACE HERE　WITH　ASSISTANT -->
			<div class="box-assist ui-widget-content ui-corner-all">
				<div class="box-title ui-state-default ui-corner-top">
					<div class="ui-icon ui-icon-pin-s float-left"></div>补充个人资料
				</div>
				<div class="box-subtitle ui-widget-content">
					<div class="ui-icon ui-icon-bookmark float-left"></div>其他
				</div>
				<div class="box-content ui-widget-content">
					<a href="#">登录</a><br />
					<a href="#">注册辅导机构</a><br />
				</div>
				<div class="box-subtitle ui-widget-content">
					<div class="ui-icon ui-icon-contact float-left"></div>联系我们
				</div>
				<div class="box-content ui-widget-content">
					<@contactus />
				</div>
			</div>
		</td>
		<td align="left" valign="top">
			<!-- REPLACE HERE WITH CONTENT -->
			<form method="post">
				<div class="box-body ui-widget-content ui-corner-all">
					<div class="box-title navbar ui-state-default ui-corner-top">
						<a href="../home.html" class="float-left"><span class="ui-icon ui-icon-home"></span></a>
						<div class="ui-icon ui-icon-carat-1-e float-left"></div>
						<a href="#" class="nav-link float-left">完成注册</a>
					</div>
					<div class="box-subtitle ui-widget-content">学生资料</div>
					<div class="box-content ui-widget-content">
						<table border="0" cellspacing="1" cellpadding="5">
						<tbody>
							<tr>
								<th width="80" align="center" class="ui-widget-header noborder">姓名<span class="required">*</span></th>
								<td width="300" align="left">
									<input type="text" name="name" value="${params.name!}" size="30" />
									<@message name="name" />
								</td>
								<td align="left" class="alpha25">学生真实姓名。</td>
							</tr>
							<tr>
								<th align="center" class="ui-widget-header noborder">性别</th>
								<td align="left">
									<@radio name="gender" value="Male" select=params.gender!"Male">男</@radio>
									<@radio name="gender" value="Female" select=params.gender>女</@radio>
									<@message name="gender" />
								</td>
								<td align="left" class="alpha25">学生性别。</td>
							</tr>
							<tr>
								<th align="center" class="ui-widget-header noborder">生日</th>
								<td align="left">
									<select name="birthday" id="birthYear">
										<option></option>
									<#list 1980..birthYear as year>
										<@option value="${year?c}" select=(params.birthday[0])!>${year?c}</@option>
									</#list>
									</select>年
									<select name="birthday" id="birthMonth">
										<option></option>
									<#list 1..12 as month>
										<@option value="${month?string('00')}" select=(params.birthday[1])!>${month?c}</@option>
									</#list>
									</select>月
									<select name="birthday" id="birthDate">
										<option></option>
									</select>日
									<@message name="birthday" />
								</td>
								<td align="left" class="alpha25">学生生日。</td>
							</tr>
							<tr>
								<th align="center" class="ui-widget-header noborder">地区<span class="required">*</span></th>
								<td align="left">
									<select name="area" id="province">
									<#list areas?keys as province>
										<@option value=province select=(params.area[0])!>${province}</@option>
									</#list>
									</select>
									<select name="area" id="city"></select>
									<select name="area" id="district"></select>
									<@message name="area" />
								</td>
								<td align="left" class="alpha25">学生所在地区。</td>
							</tr>
							<tr>
								<th align="center" class="ui-widget-header noborder">学校</th>
								<td align="left">
									<input type="text" name="school" value="${params.school!}" />
									<@message name="school" />
								</td>
								<td align="left" class="alpha25">学生就读学校名。</td>
							</tr>
							<tr>
								<th align="center" class="ui-widget-header noborder">年级<span class="required">*</span></th>
								<td align="left">
									<div id="grades">
										<#list grades?keys as grade>
											<@radio name="grade" value=grade select=params.grade!"小学">${grades[grade]}</@radio>
										</#list>
										<select name="gradeLevel"></select>
									</div>
									<@message name="grade" />
								</td>
								<td align="left" class="alpha25">学生年级。</td>
							</tr>
							<tr>
								<th align="center" class="ui-widget-header noborder">兴趣爱好</th>
								<td align="left">
									<input type="text" name="hobby" value="${params.hobby!}" />
									<@message name="hobby" />
								</td>
								<td align="left" class="alpha25">学生兴趣爱好。</td>
							</tr>
							<tr>
								<th align="center" class="ui-widget-header noborder">个人描述</th>
								<td align="left">
									<textarea name="description" rows="5" cols="30">${params.description!}</textarea>
									<@message name="description" />
								</td>
								<td align="left" class="alpha25">学生个人描述。</td>
							</tr>
							<tr>
								<th width="80" align="center" class="ui-widget-header noborder">指定解答<span class="required">*</span></th>
								<td width="300" align="left">
									<div><@checkbox id="answerAll" name="answerAll" value="true" select=params.answerAll>全部一致</@checkbox></div>
									<div id="answers">
										<#list subjects?keys as subject>
										<div>
											<input type="hidden" name="subject" value="${subjects[subject]}" />
											<label>${subjects[subject]}&nbsp;<input type="text" name="answerer" value="${(params.answerer[subject_index])!}" /></label>
										</div>
										</#list>
									</div>
									<@message name="answerer" />
								</td>
								<td align="left" class="alpha25">设置指定回答的机构或教师。</td>
							</tr>
						</tbody>
						<tfoot>
							<tr>
								<th>&nbsp;</th>
								<td align="left">
									<br />
									<input type="submit" name="registerStudent" value="下一步" class="green-button small-button ui-corner-all" />
								</td>
								<td>&nbsp;</td>
							</tr>
						</tfoot>
						</table>
					</div>
				</div>
			</form>
		</td>
	</tr>
</tbody>
<#include "/_inc/foot.html">
</table>
</body>
</html>